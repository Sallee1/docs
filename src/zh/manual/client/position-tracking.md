---
aside: false
layout: doc
title: 位置追踪
---

[文：【位置追踪】注意事项]: # 'https://support.qq.com/products/321980/faqs/102055'

​## 简介

本功能用于在空荧酒馆中同步显示玩家在游戏中的坐标，以方便查找附近的宝箱。本功能基于图像识别实现，不是外挂，不会导致封号，但识别精度有限。

若想使用本功能，请确认：

* 您的操作版本至少是**win10或以上版本**（win7不支持追踪）
* 使用**官方正版原神客户端**，不限服务器，支持Unity客户端和云原神客户端。
* 支持非官方启动器，只要游戏本体是官方正版即可。
* 游戏内【解锁神像点亮地图】，游戏内【左上角小地图】完整
* 游戏内【左上角小地图】中，无大面积遮挡（如黄色的任务范围圆圈），设置为北向上
* 未开启显卡滤镜或者其他会影响到画面颜色的选项。
* 可支持独占全屏，推荐使用【无边框全屏】模式运行游戏。

## 基础说明

成功开启位置追踪后，菜单左下角会出现自动追踪版本号。

​​![image](https://github.com/Sallee1/docs/assets/99392726/4cdb4060-6aee-4ebf-9475-df58968266ad)

将实时识别游戏内**当前角色位置**（小地图坐标位置）并同步显示到【地图客户端】上（像游戏内地图一样）。以便于对照地图，防止迷路。

![image](https://github.com/Sallee1/docs/assets/99392726/e23d5c97-9951-4f37-a33b-f39b4ba01521)

## 云原神客户端使用说明

只有7.14.2及以上版本的位置追踪对云原神做了适配，在使用之前，请确认你的位置追踪是最新版本。

建议在游戏启动之后再开启位置追踪，以防识别到错误的窗口。

云原神只支持**DirectX**截图模式，在开启位置追踪前，请在设置->位置追踪->截图模式中，将bitblt切换为DirectX。

![image](https://github.com/Sallee1/docs/assets/99392726/2b2c18fc-abd6-4c17-a08e-88521f918ed1)

此外，为了确保追踪可用，请确定：

* 分辨率大于等于1920x1080，窗口或全屏均可
* 画质在“标清”以上，越高越好
* 如果有“画质增强Beta”选项，可尝试开启

## 扩展使用

* 可在设置中开启【窗口置顶】，并拖动缩小地图窗口，以替代游戏内小地图
* 可在设置中开启【覆盖模式】，可自行设置触发快捷键，以替代游戏内大地图

## 注意事项

### 自动追踪无反应

* Win11系统可能由于使用了「窗口化游戏优化」导致追踪失败，在图形设置中开启「不使用窗口化游戏优化」（见下图）

    * 如果图像设置中没有「原神」，可以将“<游戏安装目录>/Genshin Impact Game/YuanShen.exe”添加到列表中。

![image](https://github.com/Sallee1/docs/assets/99392726/374bf277-55d4-4117-9429-e4f840d4127e)

* 如果自动追踪长时间没反应，或者出现原地卡死，可使用菜单中的“追踪截图”功能获取追踪截图，并选择“截图目录”查看。
* 如果追踪截图空白，或者追踪截图截取的是很久以前的画面，启动器的画面，空荧酒馆的画面，请尝试重启空荧酒馆客户端。如果依然无效，可以更换截图模式。
* 由于系统兼容性问题，我们提供了两种追踪模式：Bitblt、DirectX，两种模式**除兼容性外无区别**，任何一种模式能用即可。
* 如果能正常截图，但依然出现原地卡死，请检查地图是否是**北向上，分辨率是否过小（不小于1280x720，建议1920x1080以上），地图是否解锁，是否有大面积遮挡，是否有显著的特征。**若调整后依旧无法追踪，请参见文末提交反馈。
* 开启了滤镜或者HDR可能会导致无法追踪。如果追踪截图与原版画面相比有很大的色差，请关闭后试试。

### 自动追踪坐标错误

* 表现为箭头能跟着角色移动，没有晃动等异常情况，但坐标偏差很大（比如人在璃月港，箭头却在层岩巨渊）。
* 或者已经更新到新版本，但新地图依然无法追踪
  * 重启地图客户端，在设置中选择「清理定位缓存」后重新开启即可。

### 自动追踪晃动，速度慢

限于算法限制，晃动和延迟很难避免，一般10m以内算正常误差

目前存在的问题如下：

* 为了尽量减少晃动，输出结果进行了滤波，在移动时可能会出现轻微的惯性。
* 对于形状比较规则的区域（梅洛彼得堡，赤王遗迹群等）识别精度可能会大幅度下降。
* 特征不明显的区域（沙漠，平原，海洋等），坐标偏移比较严重
* 因为视角扇形的遮挡，原地转动视角可能会导致追踪小箭头抖动。

以下是减轻晃动的几个建议：

* 如果能正常截图，但时常出现乱晃的现象，请检查**分辨率是否过小（不小于1280x720，建议1920x1080以上），小地图是否解锁，是否有大面积遮挡，是否有显著的特征**。
* 若开启**滤镜、HDR**等改变色彩显示的功能，则可能会影响到自动追踪的精度。
* **后台暂停**会导致位置追踪也同时暂停，可能会导致切地图时，追踪延迟变高。
* 在配置允许的情况下，将追踪间隔调到0.1秒，能比较好的改善延迟高的问题。
* 如果在某一个区域，长时间没反应（超过3分钟以上），或者箭头跑到地图外面，请于文末与开发者联系反馈。

### 自动追踪崩溃

自动追踪（特别是DirectX模式）有概率会崩溃，崩溃的表现包括但不限于：

* 弹出「Runtime Error」窗口或者「该内存不能为Read」
* 地图客户端突然无响应
* 地图客户端自动关闭，任务栏卡派蒙
* 地图客户端所有地图消失，变成灰蓝底暗角

如果遇到以上情况，请检查「空荧酒馆」的安装目录是否生成dmp格式的文件。如果有，则证明自动追踪发生了崩溃现象。

遇到崩溃，可以先尝试清理定位缓存，如果无效，可以升级或者重装显卡驱动

如果依旧不行，请添加反馈QQ群，并把dmp文件发送给@小狸卡 分析崩溃原因
如果有其他问题请提交反馈。

紧急问题请加入开发反馈QQ群：228382171

## 更新日志

以下更新日志供参考，用于排查bug使用

### 【7.14.2】

1. 重写DirectX截图算法，降低崩溃的概率
2. 支持“云原神”追踪

### 【7.13.1】

适配旧日之海

### 【7.12.2】

修复层岩巨渊，渊下宫坐标偏差

### 【7.12.1】

适配沉玉谷

### 【7.11.1】

适配枫丹3

### 【7.10.2】

1. 修正了地下的坐标映射，现在地下坐标会更准确一些
2. 如果没有获取到坐标，将不会在枫丹左上角显示箭头
3. 降低了在地下区域，箭头瞬移到地图外的概率
4. 修复了歌剧院坐标漂移
5. 修复须弥城无法追踪

### 【7.10.0】

1. 适配枫丹2

2. 适配地下地图，暂时不支持检测层级

3. 调整坐标系，稍微提高了精度

4. 修复望舒客栈无法追踪

### 【7.9.36】

继续修复DirectX截图崩溃问题

### 【7.9.35】

修复DirectX截图崩溃问题

### 【7.9.33】

支持枫丹的水下区域追踪

### 【7.9.32】

1：支持枫丹已解锁地区追踪
2：优化主城内的识别

### 【GIv38海岛分支】

1.适配3.8活动地图
2.大幅减小了包体体积
3.修复了自动追踪缓存无法正常更新的问题

### 【7.9.5】

修复传送后箭头漂移

### 【7.9.1】

1. 改进视角识别算法
2. 提高识别稳定性
3. 修复若干DirectX的报错

### 【7.8.55】

优化定位缓存文件的大小

[文：自动神瞳]: #

## ~~[Position Tracker] Oculus Tracking~~

Functioning principle:

- If an oculus indicator appears on the minimap, that oculus will be unmarked on the map client
- If an oculus indicator does not appear at the corresponding location on the minimap, that oculus will be marked as found

---

<p>Important Note: <span style="color: red">This feature is not 100% accurate. False positives can occur when oculi don't appear on the minimap because they are vertically distant, either in the air or under ground.</span></p>
