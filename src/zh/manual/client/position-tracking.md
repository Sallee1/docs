---
aside: false
description: null
layout: doc
titleTemplate: ':title - 客户端使用手册 | 空荧酒馆'
---

[文：【位置追踪】注意事项]: # 'https://support.qq.com/products/321980/faqs/102055'

## 使用说明

- 在开启位置追踪后，《空荧酒馆》会实时获取游戏中玩家的位置，并在地图中显示小箭头，帮助玩家拖动地图并显示自己的位置，以方便玩家更快的找到需要标记的点位。

## 特性 {#capabilities}

- 本功能基于【图像识别】技术实现，不会侵入游戏进程，请放心使用，
- 离线工作，可支持大部分原神客户端的匹配，不限服务器和语言
- 适配多种屏幕比例
- 支持全地区追踪，包括渊下宫，层岩巨渊和4.0之后的地下分层地图。目前自动切换层级功能在开发中

## 开启

成功开启位置追踪后，

- 【地图客户端】右下角会**显示 UID**
  - 基于OCR识别，没有读取在线数据
  - 在窗口模式下，uid可能会因为标题栏的挤压显示在屏幕外面，可能会影响到uid的识别，但不会影响到追踪
- 筛选列表下方显示**位置追踪版本**

![image](https://github.com/Sallee1/docs/assets/99392726/b9c6cbbd-430b-4886-ac70-ee4bc9f27633)

- 自动检测游戏内**当前角色位置**（小地图坐标位置）并同步显示到【地图客户端】上（像游戏内地图一样）

![](/imgs/zh/manual/auto-tracking/autotrackingegaged.png)

---

[见：位置追踪问题排查.docx]: # '以下为 位置追踪支持列表： 内容'

## 支持的程序 {#Software}

- Windows10/11 下的原神Unity客户端
- 【已不再支持】云原神（_云原神有反录屏，无法获取到截图_）

---

## 推荐画面设置 {#Graphics}

- 支持任意分辨率（不小于 1280x720，建议1920x1080以上）
- 支持任意画面比例（推荐画面比例在 4:3~21:9 之间）
  - 如果画面是小于16:9的窄屏，则按照宽度固定计算等效分辨率
  - 如果画面是大于16:9的带鱼屏，则按照高度固定计算等效分辨率
- 支持手柄、键鼠
- 支持独占全屏和窗口（建议使用“[无边框窗口](/manual/client/fullscreen-windowed)”代替全屏模式）
- 小地图仅支持锁定方向，不支持锁定玩家视角
- 不支持秘境，室内等有独立地图的区域
- 不要使用可能影响屏幕色彩的软件，包括但不限于：
  - 第三方校色软件
  - 第三方亮度调节软件
  - Windows 11 自动 HDR (影响角度定位精确度)
  - 开启了护眼
  - 显卡滤镜

## 无法追踪怎么办

参见：[【位置追踪】注意事项](/manual/client/position-tracking)

## 问题反馈 {#Troubleshooting}

1. 位置追踪基于图像识别，不会侵入游戏进程，不存在封号的风险，如果出现封号问题，请联系官方客服，可能是其他软件导致的误封禁。
2. 图像识别的准确度并不高，可能会出现抖动，延迟这个属于图像识别本身的缺陷，无法完全解决
3. 在反馈之前，请确定程序和画面设置没有问题
4. 在反馈问题前，请确保了解位置追踪产生的日志文件，以方便为开发组排查问题:

   **追踪日志：**

   ```
   <地图安装目录>/AutoTrack.log
   ```

   可用记事本打开的文本文件（建议使用第三方文本编辑器，如 notepad3,vscode）

   **追踪截图：**

   ```
   <地图安装目录>/capture.png
   ```

   png 图像，用来排查 UI 定位的问题。因为带有 Alpha 通道，所以可能会有很大的色差，用 PS 打开或者粘贴到 QQ 上既可正常显示游戏画面

   **定位缓存：**

   ```
   <地图安装目录>/cvAutoTrack.xml
   ```

   后缀为xml，实际上是二进制文件，用于对匹配加速

   如果坐标不准确或者新地图无法追踪，可以尝试删除，会重新生成

   **崩溃镜像：**

   ```
   <地图安装目录>/cvAutoTrack-[时间].dmp
   ```

   位置追踪崩溃后自动生成的文件，如果近期没有出现崩溃的问题，可以删除

**【注意】：如果反馈群要求发送追踪截图，请不要使用截图，拍屏或者用 qq 的发送图片功能，必须要以文件的方式发送图像。可以将追踪截图的文件直接拖到聊天框来发送文件。**

[反馈方式]: # '最适合目标语言用户的反馈方式'

### 请确保[问题排查](./troubleshoot.md)的措施都尝试过，依然没有解决问题后再尝试在[开发反馈 QQ 群：228382171](https://jq.qq.com/?_wv=1027&k=EqhYN9uI)反馈相关问题。

## 帮助开发

仓库地址：https://github.com/GengGode/cvAutoTrack

位置追踪基于 **C++和OpenCV** 技术栈，如果你想参与到**空荧酒馆原神地图**位置追踪模块的开发，可以[点击这里](https://qm.qq.com/cgi-bin/qm/qr?k=wXbtoDmXCjlR8iJ-3lRwdNIOWio3quit&jump_from=webapi&authKey=aS/Be7vKSbcu/6zrmYVlpF6DsSnkHVMGT6Arn+RU+IiJf8ItKIFEXnVvfFmOL9We)加入到开发组。或者自行fork修改

[文：位置追踪问题排查.docx]: # '以下为“问题排查”内容'

```card
theme: medium
title: 官方开发反馈 QQ 群
desc: 228382171（https://jq.qq.com/?_wv=1027&k=EqhYN9uI）
link: https://jq.qq.com/?_wv=1027&k=EqhYN9uI
```

## 简介

本功能基于【图像识别】技术实现。不是外挂，不会导致封号。

若想使用本功能，请确认：

- 您的操作版本至少是win10或以上版本（win7不支持追踪）
- 使用原神客户端，不限服务器，不支持云游戏
- 游戏内【解锁神像点亮地图】，游戏内【左上角小地图】完整。
- 游戏内【左上角小地图】中，无大面积遮挡（如黄色的任务范围圆圈）
- 可支持独占全屏，推荐使用【[无边框全屏](http://support.qq.com/products/321980/faqs/97887)】模式运行游戏。

## 基础说明

成功开启位置追踪后，菜单左下角会出现自动追踪版本号。

![192584e1056ce0916dc418c79e942977.png](https://txc.gtimg.com/data/321980/2023/0825/192584e1056ce0916dc418c79e942977.png)

将实时识别游戏内当前角色位置（小地图坐标位置）并同步显示到【地图客户端】上（像游戏内地图一样）。以便于对照地图，防止迷路。

![fd745ec564afdff997a49957a17f4080.png](https://txc.gtimg.com/data/321980/2021/0611/fd745ec564afdff997a49957a17f4080.png)

## 扩展使用

可在设置中开启【窗口置顶】，并拖动缩小地图窗口，以替代游戏内小地图

可在设置中开启【覆盖模式】，可自行设置触发快捷键，以替代游戏内大地图

## 注意事项

### 自动追踪无反应

- Win11系统可能由于使用了「窗口化游戏优化」导致追踪失败，在图形设置中开启「不使用窗口化游戏优化」（见下图）

- 如果图像设置中没有「原神」，可以将“<游戏安装目录>/Genshin Impact Game/YuanShen.exe”添加到列表中。

![7c54b7ab7d92dcf0885fddb388bde9e3.jpeg](https://txc.gtimg.com/data/321980/2023/0225/7c54b7ab7d92dcf0885fddb388bde9e3.jpeg)

- 如果自动追踪长时间没反应，或者出现原地卡死，可使用菜单中的“追踪截图”功能获取追踪截图，并选择“截图目录”查看。如果追踪截图空白，或者与当前地图不符，可能是截图模式不兼容当前系统，更换截图模式即可。

- 由于系统兼容性问题，我们提供了两种追踪模式：Bitblt、DirectX，两种模式除兼容性外无区别，任何一种模式能用即可。

- 如果能正常截图，但依然出现原地卡死，请检查分辨率是否过小（不小于1280x720，建议1920x1080以上），小地图是否解锁，是否有大面积遮挡，是否有显著的特征。若调整后依旧无法追踪，请参见文末提交反馈。
- 官方的【云 · 原神】由于设置了不可捕获屏幕，所以无法追踪（可能由于防止多开脚本缘故）。

### 自动追踪坐标错误

- 表现为箭头能跟着角色移动，没有晃动等异常情况，但坐标偏差很大（比如人在璃月港，箭头却在层岩巨渊）。
- 或者已经更新到新版本，但新地图依然无法追踪

- 重启地图客户端，在设置中选择「清理定位缓存」后重新开启即可。

### 自动追踪晃动，速度慢

限于算法限制，晃动和延迟很难避免，一般10m以内算正常误差

目前存在的问题如下：

- 为了尽量减少晃动，输出结果进行了滤波，在移动时可能会出现轻微的惯性。
- 对于比较规则的区域（梅洛彼得堡，赤王遗迹群等）识别精度可能会大幅度下降。
- 特征点较少的区域，坐标偏移比较严重
- 因为视角扇形的遮挡，原地转动视角可能会导致追踪小箭头绕圈转

以下是减轻晃动的几个建议：

- 如果能正常截图，但时常出现乱晃的现象，请检查分辨率是否过小（不小于1280x720，建议1920x1080以上），小地图是否解锁，是否有大面积遮挡，是否有显著的特征。
- 若开启显卡滤镜、HDR等改变色彩显示的功能，则可能会影响到自动追踪的精度。
- 后台暂停会导致位置追踪也同时暂停，可能会导致切地图时，追踪延迟变高。
- 在配置允许的情况下，将追踪间隔调到0.1秒，能比较好的改善延迟高的问题。
- 如果在某一个区域，长时间没反应（超过3分钟以上），或者箭头跑到地图外面，请于文末与开发者联系反馈。

### 自动追踪崩溃：

- 自动追踪（特别是DirectX模式）有概率会崩溃，崩溃的表现包括但不限于：

- 弹出「Runtime Error」窗口或者「该内存不能为Read」
- 地图客户端突然无响应
- 地图客户端崩溃，任务栏卡派蒙
- 地图客户端所有地图消失，变成灰蓝底暗角

- 如果遇到以上情况，请检查「空荧酒馆」的安装目录是否生成dmp格式的文件。如果有，则证明自动追踪发生了崩溃现象。
- 遇到崩溃，可以先尝试清理定位缓存，如果无效，可以升级或者重装显卡驱动
- 如果依旧不行，请添加反馈QQ群，并把dmp文件发送给@小狸卡 分析崩溃原因

  如果有其他问题请提交反馈。

  紧急问题请加入[开发反馈QQ群：228382171](https://jq.qq.com/?_wv=1027&k=EqhYN9uI)

## 更新日志

以下更新日志供参考，用于排查bug使用

【7.10.2】

1\. 修正了地下的坐标映射，现在地下坐标会更准确一些
2\. 如果没有获取到坐标，将不会在枫丹左上角显示箭头
3\. 降低了在地下区域，箭头瞬移到地图外的概率 4. 修复了歌剧院坐标漂移 5. 修复须弥城无法追踪

#### 7.10.0

1. 适配枫丹2
2. 适配地下地图，暂时不支持检测层级
3. 调整坐标系，稍微提高了精度
4. 修复望舒客栈无法追踪

#### 7.9.36

继续修复DirectX截图崩溃问题

#### 7.9.35

修复DirectX截图崩溃问题

#### 7.9.33

支持枫丹的水下区域追踪

#### 7.9.32

1. 支持枫丹已解锁地区追踪
2. 优化主城内的识别

#### GIv38海岛分支

1.适配3.8活动地图2.大幅减小了包体体积（需要测试）3.修复了自动追踪缓存无法正常更新的问题

#### 7.9.5

修复传送后箭头漂移

#### 7.9.1

1. 改进视角识别算法
2. 提高识别稳定性
3. 修复若干DirectX的报错

#### 7.8.55

优化定位缓存文件的大小

[文：自动神瞳]: #

## ~~[Position Tracker] Oculus Tracking~~

Functioning principle:

- If an oculus indicator appears on the minimap, that oculus will be unmarked on the map client
- If an oculus indicator does not appear at the corresponding location on the minimap, that oculus will be marked as found

---

<p>Important Note: <span style="color: red">This feature is not 100% accurate. False positives can occur when oculi don't appear on the minimap because they are vertically distant, either in the air or under ground.</span></p>
